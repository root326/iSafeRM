version: "3.8"
services:
  grafana:
    image: grafana/grafana:10.2.4-ubuntu
    container_name: grafana
    deploy:
      restart_policy:
        condition: any
      replicas: 1
      placement:
        constraints:
          - node.hostname == {{ deploy_host|default('aituningnode1') }}
      resources:
        limits:
          cpus: "1"
          memory: 2G
{#    restart: unless-stopped#}
    environment:
     - GF_SERVER_ROOT_URL=http://my.grafana.server/
     - GF_INSTALL_PLUGINS=grafana-clock-panel
     - GF_PLUGIN_ALLOW_LOCAL_MODE=true
    ports:
      - target: 3000
        published: 3000
        protocol: tcp
        mode: host
    volumes:
     - '~/tuning_microservice/deploy/software/grafana/data:/var/lib/grafana'